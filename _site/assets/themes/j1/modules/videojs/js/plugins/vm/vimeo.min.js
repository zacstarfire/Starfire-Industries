/*
 # -----------------------------------------------------------------------------
 # ~/assets/themes/j1/modules/videojs/js/vimeo/vimeo.min.js
 # Provides Vimeo Playback Technology for Video.js V8 and newer
 #
 #  Product/Info:
 #  http://jekyll.one
 #
 #  Copyright (C) 2023, 2024 Juergen Adams
 #
 #  J1 Theme is licensed under MIT License.
 #  See: https://github.com/jekyll-one/J1 Theme/blob/master/LICENSE
 # -----------------------------------------------------------------------------
*/
!function(e,t){if("object"==typeof exports&&"undefined"!=typeof module){var i=require("video.js");module.exports=t(i.default||i)}else"function"==typeof define&&define.amd?define(["videojs"],function(i){return e.Vimeo=t(i)}):e.Vimeo=t(e.videojs)}(this,function(e){"use strict";var t,i,s,r,n,o=e.browser.IS_IOS||e.browser.IS_ANDROID,a=e.getTech("Tech"),h=!1;class u extends a{constructor(e,t){super(e,t),this.setPoster(e.poster);var i=this;setTimeout(function(){this.el_&&(this.el_.parentNode.className+=" vjs-vimeo",o&&(this.el_.parentNode.className+=" vjs-vimeo-mobile"),u.isSdkReady?i.initVMPlayer():u.sdkReadyQueue.push(i))}.bind(this))}initVMPlayer(){const e={url:this.options_.source.src,byline:!1,portrait:!1,title:!1};this.options_.autoplay&&(e.autoplay=!0),this.options_.height&&(e.height=this.options_.height),this.options_.width&&(e.width=this.options_.width),this.options_.maxheight&&(e.maxheight=this.options_.maxheight),this.options_.maxwidth&&(e.maxwidth=this.options_.maxwidth),this.options_.loop&&(e.loop=this.options_.loop),this.options_.color&&(e.color=this.options_.color.replace(/^#/,"")),this.vmPlayer=new VM.Player(this.el(),e),this.initVimeoState(),["play","playing","pause","ended","loaded","timeupdate","progress","seeking","seeked","ready"].forEach(e=>{this.vmPlayer.on(e,t=>{this._vimeoState.progress.duration!==t.duration&&this.trigger("durationchange"),this._vimeoState.progress=t,this.trigger(e)}),this.vmPlayer.on(e,e=>{this.vmPlayer.getVideoEmbedCode().then(function(e){}).catch(function(e){console.err("Vimeo API: an error occurred")})}),this.vmPlayer.on(e,t=>{this._vimeoState.progress.duration!==progress.duration&&this.trigger("durationchange"),this._vimeoState.progress=progress,this.trigger(e)}),this.vmPlayer.on("pause",()=>this._vimeoState.playing=!1),this.vmPlayer.on("play",()=>{document.getElementsByClassName("vjs-big-play-button");this._vimeoState.playing=!0,this._vimeoState.ended=!1})}),this.vmPlayer.on("ended",()=>{this._vimeoState.playing=!1,this._vimeoState.ended=!0}),this.vmPlayer.on("volumechange",e=>this._vimeoState.volume=e),this.vmPlayer.on("error",e=>this.trigger("error",e)),this.triggerReady()}initVimeoState(){const e=this._vimeoState={ended:!1,playing:!1,volume:0,progress:{seconds:0,percent:0,duration:0}};this.vmPlayer.getCurrentTime().then(t=>e.progress.seconds=t),this.vmPlayer.getDuration().then(t=>e.progress.duration=t),this.vmPlayer.getPaused().then(t=>e.playing=!t),this.vmPlayer.getVolume().then(t=>e.volume=t)}createEl(){const t=e.dom.createEl("div",{id:this.options_.techId});return t.style.cssText="width:100%;height:100%;top:0;left:0;position:absolute",t.className="vjs-vimeo",t}controls(){return!0}supportsFullScreen(){return!0}src(){return this.options_.source}currentSrc(){return this.options_.source.src}currentTime(){return this._vimeoState.progress.seconds}setCurrentTime(e){this.vmPlayer.setCurrentTime(e)}volume(){return this._vimeoState.volume}setVolume(e){return this.vmPlayer.setVolume(e)}duration(){return this._vimeoState.progress.duration}buffered(){const t=this._vimeoState.progress;return e.time.createTimeRanges(0,t.percent*t.duration)}paused(){return!this._vimeoState.playing}pause(){this.vmPlayer.pause()}play(){this.vmPlayer.play()}muted(){return 0===this._vimeoState.volume}ended(){return this._vimeoState.ended}currentTime(){return this.vmPlayer?this.vmPlayer.getCurrentTime():0}setCurrentTime(e){this.lastState===vmPlayer.getPaused()&&(this.timeBeforeSeek=this.currentTime()),this.isSeeking||(this.wasPausedBeforeSeek=this.paused()),this.vmPlayer.seekTo(e,!0),this.trigger("timeupdate"),this.trigger("seeking"),this.isSeeking=!0,this.lastState===vmPlayer.getPaused()&&this.timeBeforeSeek!==e&&(clearInterval(this.checkSeekedInPauseInterval),this.checkSeekedInPauseInterval=setInterval(function(){this.lastState===vmPlayer.getPaused()&&this.isSeeking?this.currentTime()!==this.timeBeforeSeek&&(this.trigger("timeupdate"),this.onSeeked()):clearInterval(this.checkSeekedInPauseInterval)}.bind(this),250))}seeking(){return this.isSeeking}seekable(){return this.vmPlayer?e.time.createTimeRanges(0,this.vmPlayer.getDuration()):e.time.createTimeRanges()}onSeeked(){clearInterval(this.checkSeekedInPauseInterval),this.isSeeking=!1,this.wasPausedBeforeSeek&&this.pause(),this.trigger("seeked")}playbackRate(){return this.vmPlayer?this.vmPlayer.getPlaybackRate():1}setPlaybackRate(e){this.vmPlayer&&this.vmPlayer.setPlaybackRate(e)}duration(){return this.vmPlayer?this.vmPlayer.getDuration():0}}u.prototype.featuresTimeupdateEvents=!0,u.isSupported=function(){return!0},a.withSourceHandlers(u),u.nativeSourceHandler={},u.nativeSourceHandler.canPlayType=function(e){return"video/vimeo"===e?"maybe":""},u.nativeSourceHandler.canHandleSource=function(e){return e.type?u.nativeSourceHandler.canPlayType(e.type):e.src?u.nativeSourceHandler.canPlayType(e.src):""},u.nativeSourceHandler.handleSource=function(e,t){t.src(e.src)},u.nativeSourceHandler.dispose=function(){},u.registerSourceHandler(u.nativeSourceHandler),u.VERSION="1.0.0",u.sdkReadyQueue=[],"undefined"!=typeof document&&(t="/assets/themes/j1/modules/videojs/js/plugins/vm/api/vimeo.min.js",i=function(){u.isSdkReady=!0;for(var e=0;e<u.sdkReadyQueue.length;++e)u.sdkReadyQueue[e].initVMPlayer()},s=!1,r=document.createElement("script"),(n=document.getElementsByTagName("script")[0])&&(n.parentNode.insertBefore(r,n),r.onload=function(){s||(s=!0,i())},r.onreadystatechange=function(){s||"complete"!==this.readyState&&"loaded"!==this.readyState||(s=!0,i())},r.src=t),function(){if(h)return;h=!0;const e="\n        .vjs-vimeo iframe {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n        }\n        .vjs-vimeo .vjs-iframe-blocker { display: none; }\n        .vjs-vimeo.vjs-user-inactive .vjs-iframe-blocker { display: block; }\n        .vjs-vimeo .vjs-poster { background-size: cover; }'\n        .vjs-vimeo-mobile .vjs-big-play-button { display: none; }\n\n        .vjs-vimeo .vjs-duration { display: none; }\n        .vjs-vimeo .vjs-remaining-time { display: none; }\n      ",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}()),void 0!==e.registerTech?e.registerTech("Vimeo",u):e.registerComponent("Vimeo",u)});
