/*
 # -----------------------------------------------------------------------------
 # ~/assets/themes/j1/modules/rtable/js/rtable.min.js
 # Tablesaw v3.1.2 implementation for J1 Theme
 #
 # Product/Info:
 # https://jekyll.one
 # https://github.com/filamentgroup/tablesaw
 #
 # Copyright (C) 2023, 2024 Juergen Adams
 # Copyright (c) 2013 Filament Group
 #
 # J1 Template is licensed under the MIT License.
 # See: https://github.com/jekyll-one-org/j1-template/blob/main/LICENSE.md
 # Tablesaw is licensed under the MIT License.
 # See: https://github.com/filamentgroup/tablesaw/blob/master/LICENSE
 # -----------------------------------------------------------------------------
*/
!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(a){return t.Tablesaw=e(a,t)}):"object"==typeof exports?module.exports=e("document"in t?require("jquery"):require("jquery")(t),t):t.Tablesaw=e(jQuery,t)}("undefined"!=typeof window?window:this,function(t,e){"use strict";var a=e.document,i=/complete|loaded/.test(a.readyState);a.addEventListener("DOMContentLoaded",function(){i=!0});var n,r,s,o,l,d,h,c={i18n:{modeStack:"Stack",modeSwipe:"Swipe",modeToggle:"Toggle",modeSwitchColumnsAbbreviated:"Cols",modeSwitchColumns:"Columns",columnToggleButton:"Columns",columnToggleError:"No eligible columns.",sort:"Sort",swipePreviousColumn:"Previous column",swipeNextColumn:"Next column"},bsMediaBreakpoints:{xl:"1200",lg:"992",md:"768",sm:"576",xs:"575",default:"992"},mustard:"head"in a&&(!e.blackberry||e.WebKitPoint)&&!e.operamini,$:t,_init:function(t,e){c.$(t||a).trigger("enhance.tablesaw"),c.options=e},init:function(t,e){(i=i||/complete|loaded/.test(a.readyState))?c._init(t,e):"addEventListener"in a&&a.addEventListener("DOMContentLoaded",function(){c._init(t,e)})}};return t(a).on("enhance.tablesaw",function(){"undefined"!=typeof TablesawConfig&&TablesawConfig.i18n&&(c.i18n=t.extend(c.i18n,TablesawConfig.i18n||{})),c.i18n.modes=[c.i18n.modeStack,c.i18n.modeSwipe,c.i18n.modeToggle]}),c.mustard&&t(a.documentElement).addClass("tablesaw-enhanced"),function(){var i="tablesaw-bar",n={create:"tablesawcreate",destroy:"tablesawdestroy",refresh:"tablesawrefresh",resize:"tablesawresize"},r={},s=log4javascript.getLogger("j1.rtable");c.events=n;var o=function(e){if(!e)throw new Error("Tablesaw requires an element.");this.table=e,this.$table=t(e),this.$thead=this.$table.children().filter("thead").eq(0),this.$tbody=this.$table.children().filter("tbody"),this.mode=this.$table.attr("data-tablesaw-mode")||"stack",this.$toolbar=null,this.attributes={subrow:"data-tablesaw-subrow",ignorerow:"data-tablesaw-ignorerow"},this.init()};o.prototype.init=function(){if(!this.$thead.length)throw new Error("tablesaw: a <thead> is required, but none was found.");if(!this.$thead.find("th").length)throw new Error("tablesaw: no header cells found. Are you using <th> inside of <thead>?");this.$table.attr("id")||this.$table.attr("id","tablesaw-"+Math.round(1e4*Math.random())),this.createToolbar(),this._initCells(),this.$table.data("tablesaw",this),this.$table.trigger(n.create,[this])},o.prototype.getConfig=function(e){var a=t.extend(r,e||{});return t.extend(a,"undefined"!=typeof TablesawConfig?TablesawConfig:{})},o.prototype._getPrimaryHeaderRow=function(){return this._getHeaderRows().eq(0)},o.prototype._getHeaderRows=function(){return this.$thead.children().filter("tr").filter(function(){return!t(this).is("[data-tablesaw-ignorerow]")})},o.prototype._getRowIndex=function(t){return t.prevAll().length},o.prototype._getHeaderRowIndeces=function(){var e=this,a=[];return this._getHeaderRows().each(function(){a.push(e._getRowIndex(t(this)))}),a},o.prototype._getPrimaryHeaderCells=function(t){return(t||this._getPrimaryHeaderRow()).find("th")},o.prototype._$getCells=function(e){var a=this;return t(e).add(e.cells).filter(function(){var e=t(this),i=e.parent(),n=e.is("[colspan]");return!(i.is("["+a.attributes.subrow+"]")||i.is("["+a.attributes.ignorerow+"]")&&n)})},o.prototype._getVisibleColspan=function(){var e=0;return this._getPrimaryHeaderCells().each(function(){var a=t(this);"none"!==a.css("display")&&(e+=parseInt(a.attr("colspan"),10)||1)}),e},o.prototype.getColspanForCell=function(e){var a=this._getVisibleColspan(),i=0;return e.closest("tr").data("tablesaw-rowspanned")&&i++,e.siblings().each(function(){var e=t(this),a=parseInt(e.attr("colspan"),10)||1;"none"!==e.css("display")&&(i+=a)}),a-i},o.prototype.isCellInColumn=function(e,a){return t(e).add(e.cells).filter(function(){return this===a}).length},o.prototype.updateColspanCells=function(e,a,i){var n=this,r=n._getPrimaryHeaderRow();this.$table.find("[rowspan][data-tablesaw-priority]").each(function(){var e=t(this);if("persist"===e.attr("data-tablesaw-priority")){var a=e.closest("tr"),i=parseInt(e.attr("rowspan"),10);i>1&&((a=a.next()).data("tablesaw-rowspanned",!0),i--)}}),this.$table.find("[colspan],[data-tablesaw-maxcolspan]").filter(function(){return t(this).closest("tr")[0]!==r[0]}).each(function(){var r=t(this);if(void 0===i||n.isCellInColumn(a,this)){var s=n.getColspanForCell(r);e&&void 0!==i&&r[0===s?"addClass":"removeClass"](e);var o=parseInt(r.attr("data-tablesaw-maxcolspan"),10);o?s>o&&(s=o):r.attr("data-tablesaw-maxcolspan",r.attr("colspan")),r.attr("colspan",s)}})},o.prototype._findPrimaryHeadersForCell=function(t){for(var e=this._getPrimaryHeaderRow(),a=this._getRowIndex(e),i=[],n=0;n<this.headerMapping.length;n++)if(n!==a)for(var r=0;r<this.headerMapping[n].length;r++)this.headerMapping[n][r]===t&&i.push(this.headerMapping[a][r]);return i},o.prototype.getRows=function(){var e=this;return this.$table.find("tr").filter(function(){return t(this).closest("table").is(e.$table)})},o.prototype.getBodyRows=function(e){return(e?t(e):this.$tbody).children().filter("tr")},o.prototype.getHeaderCellIndex=function(t){for(var e=this.headerMapping[0],a=0;a<e.length;a++)if(e[a]===t)return a;return-1},o.prototype._initCells=function(){this.$table.find("[data-tablesaw-maxcolspan]").each(function(){var e=t(this);e.attr("colspan",e.attr("data-tablesaw-maxcolspan"))});var e=this.getRows(),a=[];e.each(function(t){a[t]=[]}),e.each(function(e){var i=0;t(this).children().each(function(){for(var t=parseInt(this.getAttribute("data-tablesaw-maxcolspan")||this.getAttribute("colspan"),10),n=parseInt(this.getAttribute("rowspan"),10);a[e][i];)i++;if(a[e][i]=this,t)for(var r=0;r<t-1;r++)i++,a[e][i]=this;if(n)for(var s=1;s<n;s++)a[e+s][i]=this;i++})});for(var i=this._getHeaderRowIndeces(),n=0;n<a[0].length;n++)for(var r=0,s=i.length;r<s;r++){var o,l=a[i[r]][n],d=i[r];for(l.cells||(l.cells=[]);d<a.length;)l!==(o=a[d][n])&&l.cells.push(o),d++}this.headerMapping=a},o.prototype.refresh=function(){this._initCells(),this.$table.trigger(n.refresh,[this])},o.prototype._getToolbarAnchor=function(){var t=this.$table.parent();return t.is(".tablesaw-overflow")?t:this.$table},o.prototype._getToolbar=function(t){return t||(t=this._getToolbarAnchor()),t.prev().filter("."+i)},o.prototype.createToolbar=function(){var e=this._getToolbarAnchor(),a=this._getToolbar(e);a.length||(a=t("<div>").addClass(i).insertBefore(e)),this.$toolbar=a,this.mode&&this.$toolbar.addClass("tablesaw-mode-"+this.mode)},o.prototype.destroy=function(){this._getToolbar().each(function(){this.className=this.className.replace(/\btablesaw-mode\-\w*\b/gi,"")});var i=this.$table.attr("id");t(a).off("."+i),t(e).off("."+i),this.$table.trigger(n.destroy,[this]),this.$table.removeData("tablesaw")},t.fn.tablesaw=function(){return this.each(function(){t(this).data("tablesaw")||new o(this)})};var l=t(a);l.on("enhance.tablesaw",function(e){if(c.mustard){var a=t(e.target);a.parent().length&&(a=a.parent()),a.find("table").filter("[data-tablesaw],[data-tablesaw-mode],[data-tablesaw-sortable]").tablesaw()}});var d,h,u=!1;l.on("scroll.tablesaw",function(){u=!0,e.clearTimeout(d),d=e.setTimeout(function(){u=!1},300)}),t(e).on("resize",function(){t("table").each(function(){var a,i=t(this);t(i).hasClass("rtable")&&(t(e).width(),t(e).width()<c.bsMediaBreakpoints[c.options.breakpoint]?(a="\nhide colgroups: "+i.attr("id"),i.find("colgroup").hide(),s.debug(a)):(a="\nshow colgroup: "+i.attr("id"),i.find("colgroup").show(),s.debug(a)))}),u||(e.clearTimeout(h),h=e.setTimeout(function(){l.trigger(n.resize)},150))}),c.Table=o}(),n="tablesaw-stack",r="tablesaw-cell-label",s="tablesaw-cell-content",o="tablesaw-stack",l="data-tablesaw-no-labels",d="data-tablesaw-hide-empty",(h=function(e,a){this.tablesaw=a,this.$table=t(e),this.labelless=this.$table.is("["+l+"]"),this.hideempty=this.$table.is("["+d+"]"),this.$table.data(o,this)}).prototype.init=function(){if(this.$table.addClass(n),!this.labelless){var e=this;this.$table.find("th, td").filter(function(){return!t(this).closest("thead").length}).filter(function(){return!(t(this).is("["+l+"]")||t(this).closest("tr").is("["+l+"]")||e.hideempty&&!t(this).html())}).each(function(){var i=t(a.createElement("b")).addClass(r),n=t(this);t(e.tablesaw._findPrimaryHeadersForCell(this)).each(function(e){var n=t(this.cloneNode(!0)),r=n.find(".tablesaw-sortable-btn");n.find(".tablesaw-sortable-arrow").remove();var s=n.find("[data-tablesaw-checkall]");if(s.closest("label").remove(),s.length)i=t([]);else{e>0&&i.append(a.createTextNode(", "));for(var o,l=r.length?r[0]:n[0];o=l.firstChild;)i[0].appendChild(o)}}),i.length&&!n.find("."+s).length&&n.wrapInner("<span class='"+s+"'></span>");var o=n.find("."+r);o.length?o.replaceWith(i):(n.prepend(a.createTextNode(" ")),n.prepend(i))})}},h.prototype.destroy=function(){this.$table.removeClass(n),this.$table.find("."+r).remove(),this.$table.find("."+s).each(function(){t(this).replaceWith(t(this.childNodes))})},t(a).on(c.events.create,function(t,e){"stack"===e.mode&&new h(e.table,e).init()}).on(c.events.refresh,function(e,a){"stack"===a.mode&&t(a.table).data(o).init()}).on(c.events.destroy,function(e,a){"stack"===a.mode&&t(a.table).data(o).destroy()}),c.Stack=h,c});
